<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zx.share.platform.console.api.modules.printer.dao.PrinterDao">

	<select id="queryObject" resultType="com.zx.share.platform.bean.zx.ZxPrinterManager">
		select * from zx_printer_manager where id = #{value}
	</select>

	<select id="queryList" resultType="com.zx.share.platform.bean.zx.ZxPrinterManager">
		select * from zx_printer_manager
		<where>
			<if test="name!=null and name!=''">
				AND create_id in (
					select id from sys_user where username like concat('%',#{name},'%')
				)
			</if>
			<if test="createId!=null and createId!=''">
				AND create_id = #{createId}
			</if>
			<if test="printerCode!=null and printerCode!=''">
				AND printerCode LIKE concat('%',#{printerCode},'%')
			</if>
			<if test="startTime != null and startTime.trim() != '' ">
				AND create_time &gt;= #{startTime}
			</if>
			<if test="endTime != null and endTime.trim() != ''">
				AND create_time &lt;= #{endTime}
			</if>
			<if test="status!=null and status!=''">
				AND status = #{status}
			</if>
			<if test="province!=null and province!=''">
				AND province=#{province}
			</if>
		</where>
        <choose>
            <when test="sidx != null and sidx.trim() != ''">
                order by ${sidx} ${order}
            </when>
			<otherwise>
                order by id desc
			</otherwise>
        </choose>
		<if test="offset != null and limit != null">
			limit #{offset}, #{limit}
		</if>
	</select>
	
 	<select id="queryTotal" resultType="int">
		select count(*) from zx_printer_manager
		<where>
			<if test="name!=null and name!=''">
				AND create_id in (
				select id from sys_user where username like concat('%',#{name},'%')
				)
			</if>
			<if test="createId!=null and createId!=''">
				AND create_id = #{createId}
			</if>
			<if test="printerCode!=null and printerCode!=''">
				AND printerCode LIKE concat('%',#{printerCode},'%')
			</if>
			<if test="startTime != null and startTime.trim() != '' ">
				AND create_time &gt;= #{startTime}
			</if>
			<if test="endTime != null and endTime.trim() != ''">
				AND create_time &lt;= #{endTime}
			</if>
			<if test="status!=null and status!=''">
				AND status = #{status}
			</if>
			<if test="province!=null and province!=''">
				AND province=#{province}
			</if>
		</where>
	</select>

	<insert id="save" parameterType="com.zx.share.platform.bean.zx.ZxPrinterManager" useGeneratedKeys="true" keyProperty="id">
		INSERT INTO zx_printer_manager(
			printer_code,name,longitude,latitude,province,city,area,address,remark,create_id,create_time,update_id,update_time,manager_name,manager_phone,status
		) VALUES (#{printerCode},#{name},#{longitude},#{latitude},#{province},#{city},#{area},#{address},#{remark},#{createId},#{createTime},#{updateId},#{updateTime},#{managerName},#{managerPhone},#{status})
	</insert>
	 
	<update id="update" parameterType="com.zx.share.platform.bean.zx.ZxPrinterManager">
		  UPDATE zx_printer_manager
		  <set>
			  <if test="printerCode != null">`printer_code` = #{printerCode}, </if>
			  <if test="name != null">`name` = #{name}, </if>
			  <if test="longitude != null">`longitude` = #{longitude}, </if>
			  <if test="latitude != null">`latitude` = #{latitude}, </if>
			  <if test="province != null">`province` = #{province}, </if>
			  <if test="city != null">`city` = #{city}, </if>
			  <if test="area != null">`area` = #{area}, </if>
			  <if test="address != null">`address` = #{address}, </if>
			  <if test="remark != null">`remark` = #{remark}, </if>
			  <if test="updateId != null">`update_id` = #{updateId}, </if>
			  <if test="updateTime != null">`update_time` = #{updateTime}, </if>
			  <if test="managerName != null">`manager_name` = #{managerName}, </if>
			  <if test="managerPhone != null">`manager_phone` = #{managerPhone}, </if>
		  </set>
		  where id=#{id}
	</update>
	
	<delete id="delete">
		delete from zx_printer_manager where id = #{value}
	</delete>
	
	<update id="deleteBatch">
		 update zx_printer_manager set status=0 where id in
		<foreach item="printerId" collection="array" open="(" separator="," close=")">
			#{printerId}
		</foreach>
	</update>
	<update id="startUsing">
		update zx_printer_manager set status=1 where id in
		<foreach item="printerId" collection="array" open="(" separator="," close=")">
			#{printerId}
		</foreach>
	</update>


</mapper>